<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GanhaPlus â€” Tarefas</title>

  <link rel="icon" href="favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

  <meta name="description" content="GanhaPlus â€” Assista anÃºncios e compartilhe links para ganhar Kwanzas." />
</head>
<meta name="google-adsense-account" content="ca-pub-2536628051221233">
<body class="theme-dark dashboard-page" data-page="tarefas">

  <!-- Header -->
  <header class="site-header">
    <button id="toggle-sidebar" class="btn-hamburger" aria-label="Abrir menu">
      <span></span><span></span><span></span>
    </button>

    <div class="header-title">
      <h1>GanhaPlus</h1>
    </div>

    <div class="header-actions">
      <div class="saldo">
        <small>Saldo</small>
        <div id="saldo-valor">0 AOA</div>
      </div>
      <button id="btn-logout" class="btn-ghost">Sair</button>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2>GanhaPlus</h2>
      <span class="tag">Renda extra</span>
    </div>

    <nav class="menu">
      <a href="principal.html" class="menu-item">ğŸ  Painel</a>
      <a href="tarefa.html" class="menu-item active">ğŸ¯ Tarefas</a>
      <a href="historico.html" class="menu-item">ğŸ“œ HistÃ³rico</a>
      <a href="saque.html" class="menu-item">ğŸ’¸ Saque</a>
    </nav>

    <div class="sidebar-footer">
      <button id="btn-logout-2" class="logout-btn">Sair</button>
      <small class="muted">VersÃ£o 7.0 Â· Seguro</small>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main-content">

    <header class="topbar">
      <h2>Tarefas DisponÃ­veis</h2>
      <p class="subtitle">Assista anÃºncios e compartilhe para ganhar.</p>
      <p id="limite-anuncios" class="limite-info">
        Cada vÃ­deo contÃ©m <strong>4 anÃºncios</strong>. 1 anÃºncio = <strong>500 AOA</strong>.
      </p>
    </header>

    <section class="section-block">
      <h3 class="section-title">AÃ§Ãµes</h3>

      <div class="tarefas-grid">

        <!-- ASSISTIR -->
        <article class="tarefa-card">
          <div class="tarefa-card-body">
            <h4>Assistir VÃ­deo</h4>
            <p class="muted">Cada vÃ­deo contÃ©m 4 anÃºncios. Cada anÃºncio concluÃ­do credita 500 AOA.</p>
          </div>
          <div class="tarefa-card-actions">
            <button id="btn-assistir" class="btn-primary">Assistir VÃ­deo</button>
          </div>
        </article>

        <!-- COMPARTILHAR -->
        <article class="tarefa-card">
          <div class="tarefa-card-body">
            <h4>Compartilhar Link</h4>
            <p class="muted">Compartilhe seu link e ganhe crÃ©dito automaticamente.</p>
          </div>
          <div class="tarefa-card-actions">
            <button id="btn-compartilhar" class="btn-primary">Compartilhar</button>
          </div>
        </article>

      </div>
    </section>

    <section class="section-block">
      <h3 class="section-title">Ãšltimas AÃ§Ãµes</h3>
      <div id="historico-lista" class="historico-list">
        <div class="placeholder">Carregando histÃ³rico...</div>
      </div>
    </section>

  </main>

  <script src="app.js" defer></script>

  <script defer>
    document.addEventListener("DOMContentLoaded", () => {

      /* --- MENU LATERAL --- */
      const sidebar = document.getElementById("sidebar");
      document.getElementById("toggle-sidebar")?.addEventListener("click", () => {
        sidebar.classList.toggle("sidebar-hidden");
      });

      /* --- LOGOUT (2 botÃµes sincronizados) --- */
      const logoutNow = () => {
        localStorage.removeItem("gp_token");
        window.location.href = "login.html";
      };
      document.getElementById("btn-logout")?.addEventListener("click", logoutNow);
      document.getElementById("btn-logout-2")?.addEventListener("click", logoutNow);

      /* --- ASSISTIR ANÃšNCIOS --- */
      document.getElementById("btn-assistir")?.addEventListener("click", async () => {
        if (typeof abrirSequenciaAnuncios !== "function") {
          alert("Erro: sistema de anÃºncios nÃ£o carregou.");
          return;
        }
        try {
          await abrirSequenciaAnuncios();
          carregarPainel?.();
          carregarHistorico?.();
        } catch (err) {
          alert("NÃ£o foi possÃ­vel exibir anÃºncios. Tente novamente.");
        }
      });

      /* --- COMPARTILHAR --- */
      document.getElementById("btn-compartilhar")?.addEventListener("click", async () => {
        if (typeof compartilhar !== "function") {
          alert("FaÃ§a login para partilhar.");
          return;
        }
        try {
          await compartilhar();
          carregarPainel?.();
          carregarHistorico?.();
        } catch {
          alert("NÃ£o foi possÃ­vel registrar a partilha.");
        }
      });

      /* --- CARREGAR INTERFACE --- */
      carregarPainel?.();
      carregarHistorico?.();
    });
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2536628051221233"
     crossorigin="anonymous"></script>

</body>
</html>
